# Query to return the customer_name, product_name, and total_amount for each sale in the last 30 days.

```sql
SELECT
	cust.customer_name,
	prod.product_name,
	sale.total_amount
FROM
	Sales sale -- ‘sale’ is an alias for the Sales table
JOIN
	Customers cust ON sale.customer_id = cust.customer_id -- ‘cust’ is an alias for the Customers table
JOIN
	Products prod ON sale.product_id = prod.product_id -- ‘prod’ is an alias for the Products table
WHERE
	Sale.sale_date >= CURDATE() - INTERVAL 30 DAY;
```
# Query to find the total revenue generated by each product category in the last year.
```sql
SELECT 
    prod.category, 
    SUM(sale.total_amount) AS total_revenue
FROM 
    Sales sale
JOIN 
    Products prod ON sale.product_id = prod.product_id
WHERE 
    sale.sale_date >= CURDATE() - INTERVAL 1 YEAR
GROUP BY 
    prod.category;
```
# Query to return all customers who made purchases in 2023 and are located in the "West" region.
```sql
SELECT
    cust.customer_name
FROM
    Sales sale
JOIN
    Customers cust ON sale.customer_id = cust.customer_id
WHERE
    YEAR(sale.sale_date) = 2023
    AND cust.sales_region = 'West';
```
# Query to display the total number of sales, total quantity sold, and total revenue for each customer
```sql
SELECT 
    cust.customer_name, 
    COUNT(sale.sales_id) AS total_sales, 
    SUM(sale.quantity) AS total_quantity_sold, 
    SUM(sale.total_amount) AS total_revenue
FROM 
    Sales sale
JOIN 
    Customers cust ON sale.customer_id = cust.customer_id
GROUP BY 
    cust.customer_name;
```
# Query to find the top 3 customers (by total revenue) in the year 2023.
```sql
SELECT
    cust.customer_name,
    SUM(sale.total_amount) AS total_revenue
FROM
    Sales sale
JOIN
    Customers cust ON sale.customer_id = cust.customer_id
WHERE
    YEAR(sale.sale_date) = 2023
GROUP BY
    cust.customer_name
ORDER BY
    total_revenue DESC
LIMIT 3;
```
# Query to rank products by their total sales quantity in 2023. The result should include the product_name, total quantity sold, and rank.
```sql
SELECT
    prod.product_name,
    SUM(sale.quantity) AS total_quantity_sold,
    DENSE_RANK() OVER (ORDER BY SUM(sale.quantity) DESC) AS rank
FROM
    Sales sale
JOIN
    Products prod ON sale.product_id = prod.product_id
WHERE
     YEAR(sale.sale_date) = 2023
GROUP BY
     prod.product_name
ORDER BY
    rank;
```
# Query that categorizes customers into "New" (if they signed up in the last 6 months) or "Existing" based on their sign_up_date.
```sql
SELECT
    cust.customer_name,
    cust.sales_region,
    CASE
     WHEN cust.sign_up_date >= CURDATE() - INTERVAL 6 MONTH THEN 'New'
     ELSE 'Existing'
END AS customer_category
FROM
Customers cust;
```
# Query to return the month and year along with the total sales for each month for the last 12 months.
```sql
SELECT
    DATE_FORMAT(sale.sale_date, '%Y') AS year,
    DATE_FORMAT(sale.sale_date, '%m') AS month,
    SUM(sale.total_amount) AS total_sales
FROM
    Sales sale
WHERE
    sale.sale_date >= CURDATE() - INTERVAL 12 MONTH
GROUP BY
    year, month
ORDER BY
    Year ASC, month ASC;
```
# Query to return the product categories that generated more than $50,000 in revenue during the last 6 months.
```sql
SELECT
    prod.category,
    SUM(sale.total_amount) AS total_revenue
FROM
    Sales sale
JOIN
    Products prod ON sale.product_id = prod.product_id
WHERE
    sale.sale_date >= CURDATE() - INTERVAL 6 MONTH
GROUP BY
   prod.category
HAVING
    SUM(sale.total_amount) > 50000;
```
# Query to check for any sales where the total_amount doesn’t match the expected value (i.e., quantity  price).
```sql
SELECT
    sale.sales_id,
    cust.customer_name,
    prod.product_name,
    sale.quantity,
    prod.price,
    sale.total_amount,
    (sale.quantity  prod.price) AS expected_amount
FROM
    Sales sale
JOIN
    Products prod ON sale.product_id = prod.product_id
JOIN
    Customers cust ON sale.customer_id = cust.customer_id
WHERE
    sale.total_amount <> (sale.quantity  prod.price);
```


